# 2.1
journalctl -b -U "$(date -d "$(journalctl -b --output=short-iso | head -n 1 | cut -d' ' -f1) + 20 seconds" +"%F %T")"
Oct 15 07:57:13 localhost kernel: Linux version 6.8.0-55-generic (buildd@lcy02-amd64-095) (x86_64-linux-gnu-gcc-13 (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0, GNU ld (GNU Binutils for Ubuntu) 2.42) #57-Ubuntu SMP PREEMPT_DYNAMIC Wed Feb 12 23:42:21 UTC 2025 (Ubuntu 6.8.0-55.57-generic 6.8.12)
Oct 15 07:57:13 localhost kernel: Command line: BOOT_IMAGE=/vmlinuz-6.8.0-55-generic root=/dev/mapper/ubuntu--vg-ubuntu--lv ro
Oct 15 07:57:13 localhost kernel: KERNEL supported cpus:
Oct 15 07:57:13 localhost kernel:   Intel GenuineIntel
Oct 15 07:57:13 localhost kernel:   AMD AuthenticAMD
Oct 15 07:57:13 localhost kernel:   Hygon HygonGenuine
Oct 15 07:57:13 localhost kernel:   Centaur CentaurHauls
Oct 15 07:57:13 localhost kernel:   zhaoxin   Shanghai  
# ...
Oct 15 07:57:18 eltex-practice2-pg2-v1 systemd[1]: Startup finished in 3.112s (kernel) + 6.997s (userspace) = 10.109s.
Oct 15 07:57:18 eltex-practice2-pg2-v1 systemd[1]: dmesg.service: Deactivated successfully.
Oct 15 07:57:20 eltex-practice2-pg2-v1 ModemManager[729]: <msg> [base-manager] couldn't check support for device '/sys/devices/pci0000:00/0000:00:12.0': not supported by any plugin
Oct 15 07:57:23 eltex-practice2-pg2-v1 snapd[690]: daemon.go:548: gracefully waiting for running hooks
Oct 15 07:57:23 eltex-practice2-pg2-v1 snapd[690]: daemon.go:550: done waiting for running hooks
Oct 15 07:57:26 eltex-practice2-pg2-v1 snapd[690]: overlord.go:518: Released state lock file
Oct 15 07:57:26 eltex-practice2-pg2-v1 snapd[690]: daemon stop requested to wait for socket activation
Oct 15 07:57:26 eltex-practice2-pg2-v1 systemd[1]: snapd.service: Deactivated successfully.

# 2.2
awk '{ out = ""; for (i = 3; i <= NF; i++) { out = out $i " "}; print out  }' $(find / -name "auth.log" 2>/dev/null) | sed 's/\(\[[0-9]*\]\)//1' | sort -t' ' -k1
chage: changed password expiry for user1 
chage: changed password expiry for user2 
chage: changed password expiry for user3 
chfn: changed user 'user2' information 
chfn: changed user 'user2' information 
chfn: changed user 'user3' information 
chpasswd: pam_unix(chpasswd:chauthtok): password changed for root 
CRON: pam_unix(cron:session): session closed for user root 
# ...
usermod: add 'user1' to shadow group 'user1' 
usermod: add 'user2' to group 'group123' 
usermod: add 'user2' to shadow group 'group123' 
usermod: add 'user3' to group 'group123' 
usermod: add 'user3' to shadow group 'group123' 
usermod: change user 'user3' shell from '/bin/bash' to '/usr/sbin/nologin' 
usermod: delete 'user1' from group 'group123' 
usermod: delete 'user1' from shadow group 'group123' 

# 2.3
awk '{ out = ""; for (i = 3; i <= NF; i++) { out = out $i " "}; print out  }' $(find / -name "auth.log" 2>/dev/null) | sed 's/\(\[[0-9]*\]\)//1' | sort -t' ' -k1 | awk '{sources[$1] += 1} END {for (i in sources) printf "%d %s\n", sources[i], substr(i, 1, length(i) - 1)}' | sort -t' ' -k1 -n -r
1044 CRON
114 sshd
90 systemd-logind
90 su
74 polkitd
21 useradd
15 (systemd)
15 groupadd
13 usermod
13 sudo
8 userdel
6 passwd
5 nologin
3 login
3 gpasswd
3 chfn
3 chage
1 chpasswd

# 2.4
cat /etc/passwd | grep /usr/sbin/nologin | awk -F':' '{ print $3 " " $1 " " $4 }' | sort -t' ' -k1 -n -r | while read uid name gid; do groups=$(grep "$name" /etc/group | awk -F':' '{ printf "%s,", $1 }' | sed 's/,$//'); echo "$uid $name $groups"; done
65534 nobody 
1003 user3 users,user3,group123
998 systemd-network systemd-network
997 systemd-timesync systemd-timesync
992 systemd-resolve systemd-resolve
991 polkitd polkitd
989 fwupd-refresh fwupd-refresh
109 sshd 
108 usbmux 
107 landscape landscape
105 tcpdump tcpdump
104 uuidd uuidd
103 syslog adm,syslog
101 messagebus messagebus
42 _apt 
39 irc irc
38 list list
34 backup backup
33 www-data www-data
13 proxy proxy
10 uucp uucp
9 news news
8 mail mail
7 lp lp
6 man man
5 games games
3 sys sys,adm,systemd-journal,systemd-network,systemd-timesync,systemd-resolve,syslog
2 bin bin
1 daemon daemon

# 2.5
dmesg | grep "kernel"
[    0.041520] Booting paravirtualized kernel on KVM
[    0.041759] Unknown kernel command line parameters "BOOT_IMAGE=/vmlinuz-6.8.0-55-generic", will be passed to user space.
[    0.088581] Memory: 3933488K/4193760K available (22528K kernel code, 4443K rwdata, 14344K rodata, 4988K init, 4716K bss, 260012K reserved, 0K cma-reserved)
[    0.520266] Loaded X.509 cert 'Build time autogenerated kernel key: e0bedf6fa049a1e09bd65ebab3904f14cdd5bc68'
[    0.702086] Loaded X.509 cert 'Build time autogenerated kernel key: e0bedf6fa049a1e09bd65ebab3904f14cdd5bc68'
[    0.734378] Freeing unused kernel image (initmem) memory: 4988K
[    0.735601] Write protecting the kernel read-only data: 38912k
[    0.737002] Freeing unused kernel image (rodata/data gap) memory: 2040K
[    4.827886] systemd[1]: Listening on systemd-udevd-kernel.socket - udev Kernel Socket.
[    4.854383] systemd[1]: Mounting sys-kernel-debug.mount - Kernel Debug File System...
[    4.855364] systemd[1]: Mounting sys-kernel-tracing.mount - Kernel Trace File System...
[    5.039510] systemd[1]: Mounted sys-kernel-debug.mount - Kernel Debug File System.
[    5.041274] systemd[1]: Mounted sys-kernel-tracing.mount - Kernel Trace File System.
[    5.054540] systemd[1]: Mounting sys-kernel-config.mount - Kernel Configuration File System...
[    5.063368] systemd[1]: Mounted sys-kernel-config.mount - Kernel Configuration File System.

# 2.6
cat /var/log/kern.log | wc -l
4320

# 2.7
awk '/^Commandline:/ {commandline = $0} /^Start-Date:/ {startdate = $0} /^End-Date:/ {enddate = $0; printf "%s\n%s\n%s\n\n", commandline, startdate, enddate}' /var/log/apt/history.log
Commandline: apt-get install --reinstall apt
Start-Date: 2025-02-16  20:51:22
End-Date: 2025-02-16  20:51:24

Commandline: apt-get install --reinstall base-files
Start-Date: 2025-02-16  20:51:26
End-Date: 2025-02-16  20:51:28

# ...
Commandline: apt install bzip2
Start-Date: 2025-10-17  08:46:58
End-Date: 2025-10-17  08:47:01

Commandline: apt install 7zip
Start-Date: 2025-10-17  08:55:53
End-Date: 2025-10-17  08:55:57

